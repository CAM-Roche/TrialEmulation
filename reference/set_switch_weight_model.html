<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Set switching weight model — set_switch_weight_model • TrialEmulation</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Set switching weight model — set_switch_weight_model"><meta property="og:description" content="Set switching weight model"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">TrialEmulation</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.3.26</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/Getting-Started.html">Getting-Started</a>
    </li>
    <li>
      <a href="../articles/new-interface.html">New Interface</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/Causal-LDA/TrialEmulation/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Set switching weight model</h1>
    <small class="dont-index">Source: <a href="https://github.com/Causal-LDA/TrialEmulation/blob/main/R/trial_sequence.R" class="external-link"><code>R/trial_sequence.R</code></a></small>
    <div class="hidden name"><code>set_switch_weight_model.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Set switching weight model</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">set_switch_weight_model</span><span class="op">(</span><span class="va">object</span>, <span class="va">numerator</span>, <span class="va">denominator</span>, <span class="va">model_fitter</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for class 'trial_sequence'</span></span>
<span><span class="fu">set_switch_weight_model</span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  <span class="va">numerator</span>,</span>
<span>  <span class="va">denominator</span>,</span>
<span>  <span class="va">model_fitter</span>,</span>
<span>  eligible_wts_0 <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  eligible_wts_1 <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for class 'trial_sequence_ITT'</span></span>
<span><span class="fu">set_switch_weight_model</span><span class="op">(</span><span class="va">object</span>, <span class="va">numerator</span>, <span class="va">denominator</span>, <span class="va">model_fitter</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-object">object<a class="anchor" aria-label="anchor" href="#arg-object"></a></dt>
<dd><p>A <a href="trial_sequence.html">trial_sequence</a> object.</p></dd>


<dt id="arg-numerator">numerator<a class="anchor" aria-label="anchor" href="#arg-numerator"></a></dt>
<dd><p>Right hand side formula for the numerator model</p></dd>


<dt id="arg-denominator">denominator<a class="anchor" aria-label="anchor" href="#arg-denominator"></a></dt>
<dd><p>Right hand side formula for the denominator model</p></dd>


<dt id="arg-model-fitter">model_fitter<a class="anchor" aria-label="anchor" href="#arg-model-fitter"></a></dt>
<dd><p>A <a href="te_model_fitter-class.html">te_model_fitter</a> object, such as <a href="stats_glm_logit.html">stats_glm_logit</a></p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Other arguments used by methods.</p></dd>


<dt id="arg-eligible-wts-">eligible_wts_0<a class="anchor" aria-label="anchor" href="#arg-eligible-wts-"></a></dt>
<dd><p>Name of column containing indicator (0/1) for observation to be excluded/included in weight
model.</p></dd>


<dt id="arg-eligible-wts-">eligible_wts_1<a class="anchor" aria-label="anchor" href="#arg-eligible-wts-"></a></dt>
<dd><p>Exclude some observations when fitting the models for the inverse probability of treatment
weights. For example, if it is assumed that an individual will stay on treatment for at least 2 visits, the first 2
visits after treatment initiation by definition have a probability of staying on the treatment of 1.0 and should
thus be excluded from the weight models for those who are on treatment at the immediately previous visit. Users can
define a variable that indicates that these 2 observations are ineligible for the weight model for those who are on
treatment at the immediately previous visit and add the variable name in the argument <code>eligible_wts_1</code>. Similar
definitions are applied to <code>eligible_wts_0</code> for excluding observations when fitting the models for the inverse
probability of treatment weights for those who are not on treatment at the immediately previous visit.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p><code>object</code> is returned with <code>@switch_weights</code> set</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="trial_sequence.html">trial_sequence</a></span><span class="op">(</span><span class="st">"PP"</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="set_data.html">set_data</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">data_censored</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu">set_switch_weight_model</span><span class="op">(</span></span></span>
<span class="r-in"><span>    numerator <span class="op">=</span> <span class="op">~</span> <span class="va">age_s</span> <span class="op">+</span> <span class="va">x1</span> <span class="op">+</span> <span class="va">x3</span>,</span></span>
<span class="r-in"><span>    denominator <span class="op">=</span> <span class="op">~</span> <span class="va">x3</span> <span class="op">+</span> <span class="va">x4</span>,</span></span>
<span class="r-in"><span>    model_fitter <span class="op">=</span> <span class="fu"><a href="stats_glm_logit.html">stats_glm_logit</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Trial Sequence Object </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimand: Per-protocol </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Data </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> N: 321 observations from 89 patients </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Key: &lt;id&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         id period treatment    x1           x2    x3        x4   age      age_s</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      &lt;int&gt;  &lt;int&gt;     &lt;num&gt; &lt;num&gt;        &lt;num&gt; &lt;int&gt;     &lt;num&gt; &lt;num&gt;      &lt;num&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   1:     1      0         1     1  1.146148362     0 0.7342030    36 0.08333333</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   2:     1      1         1     1  0.002200337     0 0.7342030    37 0.16666667</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  ---                                                                           </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 320:    99      1         1     0 -1.106480738     1 0.5752681    66 2.58333333</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 321:    99      2         0     0  1.650478074     1 0.5752681    67 2.66666667</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      outcome censored eligible time_of_event  first  am_1  cumA switch</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        &lt;num&gt;    &lt;int&gt;    &lt;num&gt;         &lt;num&gt; &lt;lgcl&gt; &lt;num&gt; &lt;num&gt;  &lt;num&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   1:       0        0        1          9999   TRUE     0     1      0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   2:       0        0        0          9999  FALSE     1     2      0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  ---                                                                  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 320:       0        0        0             7  FALSE     1     2      0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 321:       0        0        0             7  FALSE     1     2      1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      regime_start time_on_regime eligible0 eligible1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             &lt;int&gt;          &lt;num&gt;     &lt;num&gt;     &lt;num&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   1:            0              0         1         0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   2:            0              1         0         1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  ---                                                </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 320:            0              1         0         1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 321:            2              2         0         1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> IPW for informative censoring: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - No weight model specified </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> IPW for treatment switch censoring: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - Numerator formula: treatment ~ age_s + x1 + x3 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - Denominator formula: treatment ~ x3 + x4 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Model fitter type: te_stats_glm_logit </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Weight models not fitted </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> No expanded data, use expand_trials() </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Outcome model: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - Outcome model not specified. Use set_outcome_model() </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> No outcome data, use load_expanded_data() </span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Roonak Rezvani, Isaac Gravestock, Li Su, Medical Research Council (MRC), F. Hoffmann-La Roche AG.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

      </footer></div>






  </body></html>

